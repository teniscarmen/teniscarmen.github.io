<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Migrador Firebase A ‚ûú B</title>
  <script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-firestore-compat.js"></script>
</head>
<body style="font-family: sans-serif; padding: 20px;">
  <h2>Migraci√≥n Firestore: Proyecto A ‚ûú Proyecto B</h2>
  <button onclick="migrarDatos()">Iniciar migraci√≥n</button>
  <pre id="log" style="margin-top:20px; background:#f4f4f4; padding:10px; max-height: 400px; overflow-y: auto;"></pre>

  <script>
    // Proyecto A (cuenta personal)
    const configA = {
      apiKey: "AIzaSyCe_HbdWlApCldi2Rk8uituDIwr_RcjAqE",
      authDomain: "tenis-1baf2.firebaseapp.com",
      projectId: "tenis-1baf2",
      storageBucket: "tenis-1baf2.firebasestorage.app",
      messagingSenderId: "1063958178043",
      appId: "1:1063958178043:web:01276f257cc083bac1285e",
      measurementId: "G-XXEEL6LMND"
    };

    // Proyecto B (cuenta propia)
    const configB = {
      apiKey: "AIzaSyABlVZR55dbT8KfuEVbnxhquwWP0VbLBy4",
      authDomain: "tenis-chidos-ags.firebaseapp.com",
      projectId: "tenis-chidos-ags",
      storageBucket: "tenis-chidos-ags.firebasestorage.app",
      messagingSenderId: "13324233273",
      appId: "1:13324233273:web:d7eb9f5a0e8ed0a4317be8"
    };

    const appA = firebase.initializeApp(configA, "appA");
    const appB = firebase.initializeApp(configB, "appB");

    const dbA = firebase.firestore(appA);
    const dbB = firebase.firestore(appB);

    async function migrarDatos() {
      const log = document.getElementById("log");
      log.textContent = "‚è≥ Iniciando migraci√≥n...\n";

      try {
        const colecciones = await dbA.listCollections();

        for (const col of colecciones) {
          const colName = col.id;
          log.textContent += `\nüìÅ Colecci√≥n: ${colName}`;

          const snapshot = await dbA.collection(colName).get();

          for (const doc of snapshot.docs) {
            const data = doc.data();
            await dbB.collection(colName).doc(doc.id).set(data);
            log.textContent += `\n   ‚úî Copiado: ${colName}/${doc.id}`;
          }
        }

        log.textContent += `\n\n‚úÖ Migraci√≥n completada con √©xito.`;
      } catch (error) {
        log.textContent += `\n‚ùå Error: ${error.message}`;
      }
    }
  </script>
</body>
</html>
